<UserControl x:Class="UpdatingParameters.Views.CommonLayoutControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converter="clr-namespace:UpdatingParameters.Views.Converters"
             xmlns:local="clr-namespace:UpdatingParameters.Views"
             xmlns:viewmodels="clr-namespace:UpdatingParameters.ViewModels"
             d:DataContext="{d:DesignInstance Type=viewmodels:ElementTypeViewModelBase}"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="800">
    <UserControl.Resources>
        <ResourceDictionary>
   <Style x:Key="LightThemeStatusBarStyle" TargetType="StatusBar">
                <Setter Property="Background" Value="#F5F5F5"/>
                <Setter Property="Foreground" Value="#333333"/>
                <Setter Property="BorderBrush" Value="#DDDDDD"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Height" Value="24"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="Padding" Value="10,2"/>
                <Setter Property="Margin" Value="0,4,10,5"/> <!-- Отступы для визуального выделения -->
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="StatusBar">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="6"
                                    SnapsToDevicePixels="True"
                                  >
                                <ItemsPresenter Margin="{TemplateBinding Padding}"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
     
            <!-- Стиль для StatusBarItem в светлой теме -->
            <Style x:Key="LightThemeStatusBarItemStyle" TargetType="StatusBarItem">
                <Setter Property="Padding" Value="8,0" />
                <Setter Property="HorizontalContentAlignment" Value="Left" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                
            </Style>

            <!-- Стиль для разделителя в StatusBar -->
            <Style x:Key="StatusBarSeparatorStyle" TargetType="Separator">
                <Setter Property="Background" Value="#E0E0E0" />
                <Setter Property="Width" Value="1" />
                <Setter Property="Margin" Value="4,0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Separator">
                            <Border Background="{TemplateBinding Background}"
                                    Width="{TemplateBinding Width}"
                                    Height="14"
                                    SnapsToDevicePixels="True" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary
                    Source="pack://application:,,,/NoNameAPI;component/Views/Resources/Themes/LightTheme.xaml" />
                <ResourceDictionary
                    Source="pack://application:,,,/NoNameAPI;component/Views/Resources/Themes/Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid Style="{DynamicResource Grid}"
          Margin="5 0 0 0">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ScrollViewer Style="{DynamicResource CustomScrollViewerStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="AUTO" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <local:CustomFormulaControl Grid.Row="0"
                                            NameParameter="ADSK_Наименование"
                                            AdskFormulas="{Binding AdskNameFormulas}"
                                            IsChecked="{Binding Path=NameIsChecked}"
                                            SearchParametersView="{Binding SearchParametersViewForName, Mode=TwoWay}"
                                            ParametersView="{Binding  Path=ParametersViewForName}"
                                            SelectParameter="{Binding SelectParameterName, Mode=TwoWay}"
                                            AddParameterFormulaCommand="{Binding AddParameterToNameFormulaCommand}"
                                            RemoveParameterFormulaCommand="{Binding RemoveParameterToNameFormulaCommand}"
                                            SelectFormula="{Binding SelectFormulaName}"
                                            MoveUpFormulaCommand="{Binding MoveUpToNameFormulaCommand}"
                                            MoveDownFormulaCommand="{Binding MoveDownToNameFormulaCommand}"
                                            CombinedValues="{Binding CombinedNameValues}"
                                            Margin="0 5" />
                <local:CustomFormulaControl Grid.Row="1"
                                            NameParameter="ADSK_Примечание"
                                            AdskFormulas="{Binding AdskNoteFormulas}"
                                            IsChecked="{Binding Path=NoteIsChecked}"
                                            SearchParametersView="{Binding SearchParametersViewForNote, Mode=TwoWay}"
                                            ParametersView="{Binding  Path=ParametersForNote}"
                                            SelectParameter="{Binding SelectParameterNote, Mode=TwoWay}"
                                            AddParameterFormulaCommand="{Binding AddParameterToNoteFormulaCommand}"
                                            RemoveParameterFormulaCommand="{Binding RemoveParameterToNoteFormulaCommand}"
                                            SelectFormula="{Binding SelectFormulaNote}"
                                            MoveUpFormulaCommand="{Binding MoveUpToNoteFormulaCommand}"
                                            MoveDownFormulaCommand="{Binding MoveDownToNoteFormulaCommand}"
                                            Margin="0 5"
                                            CombinedValues="{Binding CombinedNoteValues}" />
                <local:CustomFormulaControl2 Grid.Row="2"
                                             NameParameter="ADSK_Количество"
                                             AdskFormulas="{Binding AdskQuantityFormulas}"
                                             IsChecked="{Binding Path=QuantityIsChecked}"
                                             Parameters="{Binding Path=ParametersForQuantity}"
                                             SelectParameter="{Binding SelectParameterQuantity,Mode=TwoWay}"
                                             AddParameterFormulaCommand="{Binding AddParameterToQuantityFormulaCommand}"
                                             RemoveParameterFormulaCommand="{Binding RemoveParameterToQuantityFormulaCommand}"
                                             SelectFormula="{Binding SelectFormulaQuantity}"
                                             MoveUpFormulaCommand="{Binding MoveUpToQuantityFormulaCommand}"
                                             MoveDownFormulaCommand="{Binding MoveDownToQuantityFormulaCommand}"
                                             Margin="0 5"
                                             CombinedValues="{Binding CombinedQuantityValues}" />
            </Grid>
        </ScrollViewer>

        <DockPanel Grid.Row="1"
                   HorizontalAlignment="Right"
                   Margin="5 5 10 5 ">

            <Button
                Style="{StaticResource CommonButtonStyle2}"
                Content="Сохранить настройки"
                Command="{Binding SaveSettingsCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}">
            </Button>

            <Button
                Style="{DynamicResource CommonButtonStyle2}"
                Margin="10 0 0 0"
                Content="Обновить все элементы типа"
                Command="{Binding UpdateElementsCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}">
            </Button>

        </DockPanel>
        <StatusBar
            Grid.Row="2"
            Height="35"
            Style="{StaticResource LightThemeStatusBarStyle}">
            <StatusBarItem  HorizontalAlignment="Right" Style="{StaticResource LightThemeStatusBarItemStyle}">
                <TextBlock>
                    <Run Text="Элементов типа: "
                         Foreground="#FF666666" FontFamily="Segoe UI" />
                    <Run Text="{Binding ElementCounts}"
                         Foreground="#FF0066CC" FontWeight="SemiBold" />
                </TextBlock>
            </StatusBarItem>
        </StatusBar>
    </Grid>

</UserControl>